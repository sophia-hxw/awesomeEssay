

## 解决的问题
基于yolov3，解决两个问题：标签重写和anchor分配不平衡
### 问题重述
- 标签重写
  目标重叠的场景，若多个物体被分配到同一个网格，则后一个物体会重写这个网格的标签，导致只有后面的物体能被检测出来；这种现在在COCO上表现不明显，因为COCO的目标分布均匀，大小不一的目标会分配到不同层，但是Cityscapes上就会出现这个问题；
- anchor分配不平衡
  yolo系列的训练会采用kmean算法聚类得到特定要求的9个anchor，并且以每三个为一组，用于大输出图(检测小物体)，中等输出图和小输出图层(检测大物体)的默认anchor。   
  可以看出不同大小的物体会被这三组anchor分配到不同预测层进行预测。   
  作者指出,kmean这种设置，仅仅在：M ∼ U(0, r)情况下采用合理的。其中r是输入图片分辨率，例如416。该式子的意思是物体的大小分布是满足边界为0到r的均匀分布，也就是说在416x416图片上，各种大小尺度的bbox都会存在的情况下，kmean做法是合理的。但是可能大部分场景都是：M ∼ N (0.5r, r),即均值为0.5r，标准差为r的物体分布，如果按照默认的kmean算法对anchor的计算策略，那么由于大部分物体都是中等尺寸物体，会出现其余两个分支没有得到很好训练，或者说根本就没有训练，浪费网络。   

### 问题解决
- 标签重写
  对于标签重写问题，只能通过要么增加输入图片分辨率大小；要么增加输出特征图大小实现。本文的做法是增加输出特征图大小。
- anchor分配不平衡
  解决方式之一，在kmeans聚类时，将三个输出层的尺度作为先验，通过阈值化来将小物体分配到大特征图，大物体分配到小特征图。具体就是首先基于网络输出层感受野，定义三个大概范围尺度，然后设置两道阈值，强行将三个尺度离散化分开；然后对bbox进行单独三次聚类，每次聚类都是在前面指定的范围内选择特定的bbox进行，而不是作用于整个数据集。
  解决方式之二，只给一个输出层，为了防止标签重写，故把输出分辨率调高，也是本文的方法，选择的输出层是1/4尺度输出。


## 主要贡献   
与YOLOv3相比：Poly-YOLO的可训练参数只有60％，但mAP却提高了40％。更少参数和更低输出分辨率的Poly-YOLO  Lite，具有与YOLOv3相同的精度，但体积小三倍，速度快两倍，更适用于嵌入式设备。

## reference
[paper](https://arxiv.org/pdf/2005.13243.pdf)
[gitlab_code](https://gitlab.com/irafm-ai/poly-yolo)


